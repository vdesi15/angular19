:host {
  // This sets up a "sticky context" for the paginator.
  // The height is calculated to stop just above the site footer.
  .table-container {
    display: block; // Use block instead of flex for simpler height calculation.
    // ðŸ”¥ FIX #3: Respects the site footer. Assumes footer is ~50px tall.
    // Adjust '50px' to the actual height of your .site-footer.
    height: calc(100% - 50px);
    overflow: hidden;
  }

  /*
   * We use ::ng-deep but scope it inside :host to prevent it from leaking out.
   * The .elegant-table class provides the necessary specificity.
   */
  ::ng-deep .elegant-table {
    
    // This is the most important rule for respecting column widths.
    .p-datatable-table {
      table-layout: fixed !important;
    }

    // ðŸ”¥ FIX #1 & #2: Compact layout with smaller fonts and no outer border.
    font-size: 0.8rem; // Smaller base font for the entire table.

    // Header styling for a clean, unified look.
    .p-datatable-thead th {
      background-color: var(--surface-100);
      border-bottom: 1px solid var(--surface-border) !important;
      padding: 0.5rem 0.6rem; // Reduced padding
      font-weight: 600;
      text-align: left;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    // Filter row - even more compact
    .filter-row th {
      padding: 0.2rem 0.4rem; // Very tight padding
      background-color: var(--surface-50);
      border-bottom-width: 2px; // Heavier border to separate header from data

      .p-column-filter { width: 100%; }

      .elegant-filter-input {
        width: 100%;
        font-size: 0.75rem; // Smaller font for filters
        padding: 0.3rem 0.5rem; // Compact padding
        border: 1px solid var(--surface-200);
        border-radius: 4px;
      }
    }

    // Body row styling for data density.
    .p-datatable-tbody tr td {
      padding: 0.4rem 0.6rem; // Reduced padding
      border-bottom: 1px solid var(--surface-border);
      word-wrap: break-word;
      white-space: normal;
    }
  }

  /*
   * ðŸ”¥ FIX #3 & #4: OPAQUE, STICKY PAGINATOR WITH UPWARD-OPENING DROPDOWN
   */
  ::ng-deep .p-paginator {
    position: sticky;
    bottom: 0;
    z-index: 10; // High z-index to stay on top of table content
    background: var(--surface-card);
    border-top: 1px solid var(--surface-border);
    font-size: 0.8rem; // Compact paginator font
    padding: 0.25rem 0.5rem;

    // Target the dropdown panel specifically
    .p-dropdown .p-dropdown-panel {
      // This forces the dropdown to open upwards from the button.
      bottom: 100%;
      top: auto !important;
      margin-bottom: 4px; // Small space between dropdown and paginator bar
    }
  }

  /*
   * DARK MODE ENHANCEMENTS
   */
  &.app-dark ::ng-deep {
    // ðŸ”¥ FIX #2: No ugly white border in dark mode.
    // The background color of the table will blend with the container.
    .elegant-table {
      .p-datatable-thead th {
        background-color: var(--surface-800);
        border-color: var(--surface-700);
      }
      .filter-row {
        background-color: var(--surface-700);
        .elegant-filter-input {
          background-color: var(--surface-800);
          border-color: var(--surface-600);
          color: var(--text-color);
        }
      }
    }
    .p-paginator {
      background: var(--surface-800);
      border-top-color: var(--surface-700);
    }
  }
}