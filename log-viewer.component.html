<div #tableContainer class="table-container">
  <p-table #logTable [value]="tableData" [columns]="visibleColumns" [totalRecords]="totalRecords" dataKey="_id"
    [paginator]="true" [rows]="20" [rowsPerPageOptions]="[25, 50, 100, 250]" [scrollable]="true" scrollHeight="flex"
    [resizableColumns]="true" columnResizeMode="expand" showGridlines
    styleClass="p-datatable-striped p-datatable-sm p-datatable-gridlines compact-filters">


    <ng-template pTemplate="header" let-columns>
      <!-- Column Display Names -->
      <tr>
        @for(col of columns; track col.id) {
        <th pResizableColumn [width]="col.width">
          {{ col.displayName }}
        </th>
        }
      </tr>
      <!-- Per-Column Filter Inputs -->
      <tr class="filter-row">
        @for(col of columns; track col.id) {
        <th class="filter-header">
          @if(col.enableFiltering) {
          <p-columnFilter [field]="col.id+'_filter'" matchMode="contains" [showMenu]="false" showClearButton="false" >
            <ng-template pTemplate="filter" let-value let-filter="filterCallback">
              <input type="text" pInputText [ngModel]="value" (ngModelChange)="filter($event)" [style.width]="col.width"
                class="p-inputtext-sm w-full"
                [placeholder]="" (click)="$event.stopPropagation()" style="width: 1500px;">
            </ng-template>
          </p-columnFilter>
          }
        </th>
        }
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-rowData let-columns="columns">
      <tr (click)="handleRowClick(rowData)" class="p-selectable-row">
        @for(col of columns; track col.id){
        <td [class.clickable-cell]="isCellClickable(col, rowData)" (click)="handleCellClick(col, rowData, $event, getCellValue(rowData, col.field))"
          tooltipPosition="top" [innerHTML]="getCellDisplayValue(rowData, col)">
        </td>
        }
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage" let-columns>
      <tr>
        <td [attr.colspan]="columns.length" class="text-center p-4">No records found.</td>
      </tr>
    </ng-template>
  </p-table>
</div>
